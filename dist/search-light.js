!function(t){function e(i){if(s[i])return s[i].exports;var n=s[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var s={};return e.m=t,e.c=s,e.i=function(t){return t},e.d=function(t,s,i){e.o(t,s)||Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,s){"use strict";function i(t,e){for(var s in e){var i=e[s];i.configurable=i.enumerable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s,i)}return t}function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function r(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var a,c,o,h,l,u,_,f=function(){function t(t,e){var s=[],i=!0,n=!1,r=void 0;try{for(var a,c=t[Symbol.iterator]();!(i=(a=c.next()).done)&&(s.push(a.value),!e||s.length!==e);i=!0);}catch(t){n=!0,r=t}finally{try{!i&&c.return&&c.return()}finally{if(n)throw r}}return s}return function(e,s){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,s);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=(u={state_:{matches:[],partial:[],allItems:[],searchText:"",searchTerms:[],properties:[],filters:[],error:!1,errorMessage:"",index:0,lastIndex:0,totalMatches:0,ready:!1,complete:!1,searched:!1},settings_:{collectionType:"array",comparison:{case:!1},relevance:{threshold:1,sort:!1},inject:{property:"searchResults",relevance:!1,missingTerms:!1}},for:function(t){return this.state_.searchText="",this.state_.filters=[],this.and.call(this,t)},and:function(t){if(this.state_.ready=!1,this.state_.complete=!1,this.state_.searched=!1,"string"==typeof t)this.state_.searchText=(this.state_.searchText+" "+t).trim();else if("object"===(void 0===t?"undefined":d(t))){var e=void 0,s=void 0,i=void 0;if(Array.isArray(t)){var n=f(t,3);e=n[0],s=n[1],i=n[2]}else e=t.key,s=t.operator,i=t.value;void 0===i&&(i=s,s="=="),this.state_.filters.push([e,s,i])}else console.warn("Invalid constraint type: ",void 0===t?"undefined":d(t));return this},in:function(t){return this.state_.properties=[],this.or.call(this,t)},or:function(t){if(this.state_.ready=!1,this.state_.complete=!1,this.state_.searched=!1,"string"==typeof t)this.state_.properties.push(t);else{var e;(e=this.state_.properties).push.apply(e,r(t))}return this},sortedBy:function(t){return this.state_.complete=!1,this.settings_.relevance.sort="relevance"===t,this},then:function(t,e){return new Promise(function(t,e){this.functions_.updateMatches_.call(this),this.state_.error?e(Error(this.state_.errorMessage)):t({matches:this.matches,partialMatches:this.partialMatches,allMatches:this.allMatches})}.bind(this)).then(t,e),this},catch:function(t){return this.then(void 0,t)}},n(u,Symbol.iterator,function(){return this.updateMatches_(),this.settings_.inject.relevance&&this.settings_.inject.missingTerms?{next:this.nextIteratorInjectAll_.bind(this)}:this.settings_.inject.relevance?{next:this.nextIteratorInjectRelevance_.bind(this)}:this.settings_.inject.missingTerms?{next:this.nextIteratorInjectMissingTerms_.bind(this)}:{next:this.nextIterator_.bind(this)}}),n(u,"functions_",{nextIterator_:function(){return this.state_.index>this.state_.lastIndex?{done:!0}:{done:!1,value:this.functions_.getItem_(this.state_.matches[this.state_.index++])}},nextIteratorInjectAll_:function(){return this.state_.index>this.state_.lastIndex?{done:!0}:{done:!1,value:this.functions_.getItemInjectAll_(this.state_.matches[this.state_.index++])}},nextIteratorInjectRelevance_:function(){return this.state_.index>this.state_.lastIndex?{done:!0}:{done:!1,value:this.functions_.getItemInjectRelevance_(this.state_.matches[this.state_.index++])}},nextIteratorInjectMissingTerms_:function(){return this.state_.index>this.state_.lastIndex?{done:!0}:{done:!1,value:this.functions_.getItemInjectMissingTerms_(this.state_.matches[this.state_.index++])}},search_:function(t){var e=[];return Array.isArray(t)?e=[].concat(r(t.keys())):"object"===(void 0===t?"undefined":d(t))?(e=Object.keys(t).filter(function(e){return t.hasOwnProperty(e)}),this.settings_.collectionType="object"):(this.state_.error=!0,this.state_.errorMessage="Invalid items type: ",void 0===t||d(t),console.warn(this.state_.errorMessage)),this.state_.collection=new Map(e.map(function(e){return[e,t[e]]})),this.state_.complete=!1,this.state_.searched=!1,this},propertyIterator_:function(t,e){return t[e]||null},searchIterator_:function(t,e,s){var i=e.split(s).length-1;i?t[1]+=i:t[2]+=" "+s},filterIterator_:function(t,e,s){var i=s[0],n=s[1],r=s[2];if("string"!=typeof t)switch(n){case"==":e[1]+=t[i]==r;break;case"===":e[1]+=t[i]===r;break;case"!=":e[1]+=t[i]!=r;break;case"!==":e[1]+=t[i]!==r;break;case">":e[1]+=t[i]>r;break;case">=":e[1]+=t[i]>=r;break;case"<":e[1]+=t[i]<r;break;case"<=":e[1]+=t[i]<=r;break;default:console.warn("Invalid filter operator:",n)}},checkRelevance_:function(t,e){var s=[e,0,""],i="";this.state_.filters.forEach(this.functions_.filterIterator_.bind(this,t,s)),i="string"==typeof t?t:this.state_.properties.length?this.state_.properties.map(this.functions_.propertyIterator_.bind(this,t)).join("|"):Array.isArray(t)?t.join("|"):Object.values(t).join("|"),this.settings_.comparison.case||(i=i.toLowerCase()),this.state_.searchTerms.forEach(this.functions_.searchIterator_.bind(this,s,i)),this.state_.allItems.push(s),0===s[1]||(s[1]<this.settings_.relevance.threshold?this.state_.partial.push(s):this.state_.matches.push(s))},emptyMatchIterator_:function(t){return[t,0,""]},reduceIterator_:function(t,e){return t[e[0]]=this.functions_.getItem_.call(this,e),t},reduceIteratorInjectAll_:function(t,e){return t[e[0]]=this.functions_.getItemInjectAll_.call(this,e),t},reduceIteratorInjectRelevance_:function(t,e){return t[e[0]]=this.functions_.getItemInjectRelevance_.call(this,e),t},reduceIteratorInjectMissingTerms_:function(t,e){return t[e[0]]=this.functions_.getItemInjectMissingTerms_.call(this,e),t},sortComparator_:function(t,e){return e[1]>t[1]?1:e[1]===t[1]?e[0]<t[0]:-1},performSearch_:function(){this.functions_.isConstrained.call(this)?(this.state_.allItems=[],this.state_.matches=[],this.state_.partial=[],this.state_.collection.forEach(this.functions_.checkRelevance_.bind(this))):(this.state_.allItems=Array.from(this.state_.collection.keys()).map(this.functions_.emptyMatchIterator_),this.state_.matches=this.state_.allItems,this.state_.partial=[]),this.state_.searched=!0},updateMatches_:function(){return this.state_.complete||(this.state_.searched||this.functions_.performSearch_.call(this),this.functions_.performSort_.call(this,this.state_.matches),this.state_.totalMatches=this.state_.matches.length,this.state_.index=0,this.state_.lastIndex=this.state_.totalMatches-1,this.state_.complete=!0),this},performSort_:function(t){this.settings_.relevance.sort&&this.functions_.isConstrained.call(this)&&t.length&&t.sort(this.functions_.sortComparator_)},getItem_:function(t){return this.state_.collection.get(t[0])},getItemInjectAll_:function(t){var e=this.state_.collection.get(t[0]);if(Array.isArray(e))e.push({relevance:t[1],missing:t[2]});else{if("object"!==(void 0===e?"undefined":d(e)))return e;e[this.settings_.inject.property]={relevance:t[1],missing:t[2]}}},getItemInjectRelevance_:function(t){var e=this.state_.collection.get(t[0]);if(Array.isArray(e))e.push({relevance:t[1]});else{if("object"!==(void 0===e?"undefined":d(e)))return e;e[this.settings_.inject.property]={relevance:t[1]}}},getItemInjectMissingTerms_:function(t){var e=this.state_.collection.get(t[0]);if(Array.isArray(e))e.push({missing:t[2]});else{if("object"!==(void 0===e?"undefined":d(e)))return e;e[this.settings_.inject.property]={missing:t[2]}}},toOriginalFormat_:function(t){return"array"===this.settings_.collectionType?this.settings_.inject.relevance&&this.settings_.inject.missingTerms?t.map(this.functions_.getItemInjectAll_,this):this.settings_.inject.relevance?t.map(this.functions_.getItemInjectRelevance_,this):this.settings_.inject.missingTerms?t.map(this.functions_.getItemInjectMissingTerms_,this):t.map(this.functions_.getItem_,this):this.settings_.inject.relevance&&this.settings_.inject.missingTerms?t.reduce(this.functions_.reduceIteratorInjectAll_.bind(this),{}):this.settings_.inject.relevance?t.reduce(this.functions_.reduceIteratorInjectRelevance_.bind(this),{}):this.settings_.inject.missingTerms?t.reduce(this.functions_.reduceIteratorInjectMissingTerms_.bind(this),{}):t.reduce(this.functions_.reduceIterator_.bind(this),{})},updateConstraints_:function(){this.state_.ready||(""===this.state_.searchText?this.state_.searchTerms=[]:this.state_.searchTerms=(this.settings_.comparison.case?this.state_.searchText:this.state_.searchText.toLowerCase()).split(" "),this.state_.ready=!0)},isConstrained:function(){return this.functions_.updateConstraints_.call(this),this.state_.searchTerms.length||this.state_.filters.length}}),a="length",_={},_[a]=_[a]||{},_[a].get=function(){return this.functions_.updateMatches_.call(this),this.state_.totalMatches},c="matches",_[c]=_[c]||{},_[c].get=function(){this.functions_.updateMatches_.call(this);var t=this.functions_.toOriginalFormat_.call(this,this.state_.matches);return console.log(this),t},o="partialMatches",_[o]=_[o]||{},_[o].get=function(){return this.functions_.updateMatches_.call(this),this.functions_.performSort_.call(this,this.state_.partial),this.functions_.toOriginalFormat_.call(this,this.state_.partial)},h="allMatches",_[h]=_[h]||{},_[h].get=function(){this.functions_.updateMatches_.call(this);var t=this.state_.matches.concat(this.state_.partial);return this.functions_.performSort_.call(this,t),this.functions_.toOriginalFormat_.call(this,t)},l="allItems",_[l]=_[l]||{},_[l].get=function(){return this.functions_.updateMatches_.call(this),this.functions_.performSort_.call(this,this.state_.allItems),this.functions_.toOriginalFormat_.call(this,this.state_.allItems)},i(u,_),u);p.search=p.functions_.search_.bind(p),e.default=p.search,"undefined"!=typeof window?window.SearchLight=p:"function"==typeof define&&s(0)&&define([],function(){return p.search})}]);